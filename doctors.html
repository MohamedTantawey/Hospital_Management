<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Doctors - Mini Hospital Appointment System</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!-- Navigation Bar -->
    <nav class="navbar">
      <div class="nav-container">
        <div class="nav-logo">
          <h2>üè• Mini Hospital</h2>
        </div>
        <ul class="nav-menu">
          <li class="nav-item">
            <a href="home.html" class="nav-link">Home</a>
          </li>
          <li class="nav-item">
            <a href="doctors.html" class="nav-link active">Doctors</a>
          </li>
          <li class="nav-item">
            <a href="patients.html" class="nav-link">Patients</a>
          </li>
          <li class="nav-item">
            <a href="appointments.html" class="nav-link">Appointments</a>
          </li>
          <li class="nav-item">
            <a href="index.html" class="nav-link logout">Logout</a>
          </li>
        </ul>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
      <div class="container">
        <div class="page-header">
          <h1>Our Medical Team</h1>
          <p>Meet our qualified doctors and specialists</p>
        </div>

        <!-- Doctors Grid -->
        <div class="doctors-section">
          <div class="section-header">
            <h2>Our Medical Team</h2>
            <button id="clearDoctorsBtn" class="clear-btn">
              Clear All Doctors
            </button>
          </div>

          <div id="doctorsGrid" class="doctors-grid">
            <!-- Doctors will be dynamically loaded here -->
          </div>

          <div
            id="noDoctorsMessage"
            class="no-data-message"
            style="display: none"
          >
            <p>No doctors added yet. Add a new doctor using the form above.</p>
          </div>
        </div>

        <!-- Add Doctor Form -->
        <div class="form-section">
          <h2>Add New Doctor</h2>
          <form id="doctorForm" class="doctor-form">
            <div class="form-row">
              <div class="form-group">
                <label for="doctorName">Full Name:</label>
                <input type="text" id="doctorName" name="doctorName" required />
              </div>
              <div class="form-group">
                <label for="doctorSpecialty">Specialty:</label>
                <input
                  type="text"
                  id="doctorSpecialty"
                  name="doctorSpecialty"
                  required
                />
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="doctorEmail">Email:</label>
                <input
                  type="email"
                  id="doctorEmail"
                  name="doctorEmail"
                  required
                />
              </div>
              <div class="form-group">
                <label for="doctorPhone">Phone:</label>
                <input
                  type="tel"
                  id="doctorPhone"
                  name="doctorPhone"
                  required
                />
              </div>
            </div>
            <div class="form-group">
              <label for="doctorDescription">Description:</label>
              <textarea
                id="doctorDescription"
                name="doctorDescription"
                rows="3"
                placeholder="Brief description of the doctor's experience and expertise..."
              ></textarea>
            </div>
            <div class="form-actions">
              <button type="submit" class="submit-btn">Add Doctor</button>
              <button
                type="button"
                id="cancelEditBtn"
                class="cancel-btn"
                style="display: none"
              >
                Cancel Edit
              </button>
            </div>
          </form>
        </div>

        <!-- Quick Actions -->
        <div class="quick-actions">
          <h2>Quick Actions</h2>
          <div class="action-buttons">
            <a href="appointments.html" class="action-btn primary"
              >Book Appointment</a
            >
            <a href="patients.html" class="action-btn secondary">Add Patient</a>
          </div>
        </div>
      </div>
    </main>

    <script>
      // Global variable to track which doctor is being edited
      let editingDoctorId = null;

      // Doctor management functionality
      document.addEventListener("DOMContentLoaded", function () {
        initializeDoctors(); // Initialize with default doctors if none exist
        loadDoctors(); // Load existing doctors on page load
      });

      // Handle form submission
      document
        .getElementById("doctorForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();
          addDoctor();
        });

      // Handle clear all doctors button
      document
        .getElementById("clearDoctorsBtn")
        .addEventListener("click", function () {
          if (
            confirm(
              "Are you sure you want to clear all doctors? This action cannot be undone."
            )
          ) {
            clearAllDoctors();
          }
        });

      // Handle cancel edit button
      document
        .getElementById("cancelEditBtn")
        .addEventListener("click", function () {
          cancelEdit();
        });

      // Function to initialize with default doctors if none exist
      function initializeDoctors() {
        let doctors = JSON.parse(localStorage.getItem("doctors")) || [];

        // If no doctors exist, add default ones
        if (doctors.length === 0) {
          const defaultDoctors = [
            {
              id: 1,
              name: "Dr. Sarah Johnson",
              specialty: "Cardiologist",
              email: "sarah.johnson@hospital.com",
              phone: "(555) 123-4567",
              description:
                "Specializes in heart conditions and cardiovascular diseases. 15+ years of experience.",
              avatar: "üë®‚Äç‚öïÔ∏è",
            },
            {
              id: 2,
              name: "Dr. Michael Chen",
              specialty: "Neurologist",
              email: "michael.chen@hospital.com",
              phone: "(555) 234-5678",
              description:
                "Expert in brain and nervous system disorders. Board-certified neurologist.",
              avatar: "üë©‚Äç‚öïÔ∏è",
            },
            {
              id: 3,
              name: "Dr. Emily Rodriguez",
              specialty: "Pediatrician",
              email: "emily.rodriguez@hospital.com",
              phone: "(555) 345-6789",
              description:
                "Dedicated to children's health from infancy through adolescence.",
              avatar: "üë®‚Äç‚öïÔ∏è",
            },
            {
              id: 4,
              name: "Dr. David Wilson",
              specialty: "Orthopedic Surgeon",
              email: "david.wilson@hospital.com",
              phone: "(555) 456-7890",
              description:
                "Specializes in bone, joint, and muscle surgery. Sports medicine expert.",
              avatar: "üë©‚Äç‚öïÔ∏è",
            },
            {
              id: 5,
              name: "Dr. Lisa Thompson",
              specialty: "Dermatologist",
              email: "lisa.thompson@hospital.com",
              phone: "(555) 567-8901",
              description:
                "Expert in skin, hair, and nail conditions. Cosmetic dermatology specialist.",
              avatar: "üë®‚Äç‚öïÔ∏è",
            },
            {
              id: 6,
              name: "Dr. Robert Kim",
              specialty: "General Practitioner",
              email: "robert.kim@hospital.com",
              phone: "(555) 678-9012",
              description:
                "Primary care physician providing comprehensive health services for all ages.",
              avatar: "üë©‚Äç‚öïÔ∏è",
            },
          ];

          localStorage.setItem("doctors", JSON.stringify(defaultDoctors));
        }
      }

      // Function to add or update a doctor
      function addDoctor() {
        // Get form data
        const name = document.getElementById("doctorName").value;
        const specialty = document.getElementById("doctorSpecialty").value;
        const email = document.getElementById("doctorEmail").value;
        const phone = document.getElementById("doctorPhone").value;
        const description = document.getElementById("doctorDescription").value;

        // Validate form
        if (!name || !specialty || !email || !phone) {
          alert("Please fill in all required fields.");
          return;
        }

        // Validate email format
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
          alert("Please enter a valid email address.");
          return;
        }

        // Get existing doctors from localStorage
        let doctors = JSON.parse(localStorage.getItem("doctors")) || [];

        if (editingDoctorId) {
          // Update existing doctor
          const doctorIndex = doctors.findIndex(
            (d) => d.id === editingDoctorId
          );
          if (doctorIndex !== -1) {
            doctors[doctorIndex] = {
              ...doctors[doctorIndex],
              name: name,
              specialty: specialty,
              email: email,
              phone: phone,
              description: description || "No description provided.",
            };

            // Save back to localStorage
            localStorage.setItem("doctors", JSON.stringify(doctors));

            // Reset edit mode
            editingDoctorId = null;
            document.querySelector(".submit-btn").textContent = "Add Doctor";
            document.getElementById("cancelEditBtn").style.display = "none";

            // Clear form
            document.getElementById("doctorForm").reset();

            // Reload doctors list
            loadDoctors();

            // Show success message
            alert("Doctor updated successfully!");
          }
        } else {
          // Add new doctor
          const doctor = {
            id: Date.now(), // Simple ID generation using timestamp
            name: name,
            specialty: specialty,
            email: email,
            phone: phone,
            description: description || "No description provided.",
            avatar: "üë®‚Äç‚öïÔ∏è", // Default avatar
            dateAdded: new Date().toLocaleDateString(),
          };

          // Add new doctor
          doctors.push(doctor);

          // Save back to localStorage
          localStorage.setItem("doctors", JSON.stringify(doctors));

          // Clear form
          document.getElementById("doctorForm").reset();

          // Reload doctors list
          loadDoctors();

          // Show success message
          alert("Doctor added successfully!");
        }
      }

      // Function to load and display doctors
      function loadDoctors() {
        const doctors = JSON.parse(localStorage.getItem("doctors")) || [];
        const doctorsGrid = document.getElementById("doctorsGrid");
        const noDoctorsMessage = document.getElementById("noDoctorsMessage");

        if (doctors.length === 0) {
          doctorsGrid.innerHTML = "";
          noDoctorsMessage.style.display = "block";
        } else {
          noDoctorsMessage.style.display = "none";
          doctorsGrid.innerHTML = doctors
            .map(
              (doctor) => `
                    <div class="doctor-card">
                        <div class="doctor-avatar">${doctor.avatar}</div>
                        <h3>${doctor.name}</h3>
                        <p class="specialty">${doctor.specialty}</p>
                        <p class="contact">üìß ${doctor.email}</p>
                        <p class="contact">üìû ${doctor.phone}</p>
                        <div class="doctor-info">
                            <p>${doctor.description}</p>
                            <p class="date-added"><small>Added: ${doctor.dateAdded}</small></p>
                        </div>
                        <div class="doctor-actions">
                            <button onclick="editDoctor(${doctor.id})" class="edit-btn">Edit</button>
                            <button onclick="deleteDoctor(${doctor.id})" class="delete-btn">Delete</button>
                        </div>
                    </div>
                `
            )
            .join("");
        }
      }

      // Function to delete a specific doctor
      function deleteDoctor(doctorId) {
        if (confirm("Are you sure you want to delete this doctor?")) {
          let doctors = JSON.parse(localStorage.getItem("doctors")) || [];
          doctors = doctors.filter((doctor) => doctor.id !== doctorId);
          localStorage.setItem("doctors", JSON.stringify(doctors));
          loadDoctors(); // Reload the list
          alert("Doctor deleted successfully!");
        }
      }

      // Function to edit a doctor
      function editDoctor(doctorId) {
        const doctors = JSON.parse(localStorage.getItem("doctors")) || [];
        const doctor = doctors.find((d) => d.id === doctorId);

        if (doctor) {
          // Store the ID of the doctor being edited
          editingDoctorId = doctorId;

          // Pre-fill the form fields
          document.getElementById("doctorName").value = doctor.name;
          document.getElementById("doctorSpecialty").value = doctor.specialty;
          document.getElementById("doctorEmail").value = doctor.email;
          document.getElementById("doctorPhone").value = doctor.phone;
          document.getElementById("doctorDescription").value =
            doctor.description;

          // Change button text to indicate edit mode
          document.querySelector(".submit-btn").textContent = "Update Doctor";

          // Show cancel button
          document.getElementById("cancelEditBtn").style.display =
            "inline-block";

          // Scroll smoothly to form
          document
            .getElementById("doctorForm")
            .scrollIntoView({ behavior: "smooth" });
        }
      }

      // Function to cancel edit mode
      function cancelEdit() {
        // Reset edit mode
        editingDoctorId = null;

        // Reset button text
        document.querySelector(".submit-btn").textContent = "Add Doctor";

        // Hide cancel button
        document.getElementById("cancelEditBtn").style.display = "none";

        // Clear form
        document.getElementById("doctorForm").reset();
      }

      // Function to clear all doctors
      function clearAllDoctors() {
        localStorage.removeItem("doctors");
        loadDoctors(); // Reload the list
        alert("All doctors have been cleared.");
      }
    </script>
  </body>
</html>
